!function(){"use strict";var defaults,methodsMapping,siteProtocol;siteProtocol="https:",defaults={protocol:siteProtocol,devPort:"9000",sponsor:{name:"direct",title:"Benutech",site:"https://direct.titletoolbox.com/",logoURL:"https://s3-us-west-1.amazonaws.com/titletoolbox/company+logos/Benutech/Benute+Logo.png",TOSURL:"https://direct.api.titletoolbox.com/pages/tos/direct_tos"},enabledFeatures:"iLookupWidget",baseURLPattern:"https://{{sponsorName}}.api.titletoolbox.com/",scopedBootstrap:!1,classScopedBootstrap:"scoped-bootstrap",classScopedBootstrapHtml:"scoped-bootstrap--html",classScopedBootstrapBody:"scoped-bootstrap--body",debug:!1,sdkPrefix:"ttb-sdk",autoFillAttr:"data-ttb-field",iframeOptions:{height:"600px"},modalOptions:{sizeClass:"modal-lg",autoDestroy:!0},modalTemplate:['<div id={{modalId}} class="ttb-sdk--modal modal" tabindex="-1" role="dialog" aria-labelledby="{{modalId}}-label" aria-hidden="true">',' <div class="modal-dialog {{sizeClass}}" role="document">','  <div class="modal-content">','   <div class="modal-header">','    <button type="button" class="close" data-dismiss="modal" aria-label="Close" title="Close">','     <span aria-hidden="true">&times;</span>',"    </button>",'    <h4 class="modal-title" id="{{modalId}}-label">{{title}}</h4>',"   </div>",'   <div class="modal-body">',"    {{bodyContent}}","   </div>","  </div>"," </div>","</div>"].join("")},methodsMapping={LOGIN:{methodName:"login",endpoint:"webservices/login.json"},LOGIN_REMOTE:{methodName:"loginRemote",endpoint:"webservices/remote_login.json"},LOGOUT:{methodName:"logout",endpoint:"webservices/logout.json"},GET_USER_PROFILE:{methodName:"TTB.getUserProfile",endpoint:"webservices/get_vendor_user.json"},GET_VENDOR_PROFILE:{methodName:"TTB.getVendorProfile",endpoint:"webservices/get_vendor/{{partnerKey}}.json"},GET_SPONSORS:{methodName:"TTB.getSponsors",endpoint:"webservices/get_sponsors.json"},GET_SPONSOR_SELECTION:{methodName:"TTB.getSponsorSelection",endpoint:"webservices/get_sponsor_selection.json"},SAVE_SPONSOR_SELECTION:{methodName:"saveSponsorSelection",endpoint:"webservices/save_sponsor_selection.json"},CLEAR_SPONSOR_SELECTION:{methodName:"clearSponsorSelection",endpoint:"webservices/clear_sponsor_selection.json"},ACCEPT_SPONSOR_TOS:{methodName:"TTB.getSponsors",endpoint:"webservices/accept_tos/accept.json"},SEARCH_PARCEL:{methodName:"searchByParcelNumber",endpoint:"webservices/search_parcel_number.json"},SEARCH_PROPERTY:{methodName:"searchBySiteAddress",endpoint:"webservices/search_property/ttb.json"},SEARCH_OWNER:{methodName:"searchByOwnerName",endpoint:"webservices/search_owner_name/ttb.json"},ORDER_REPORT:{methodName:"orderReport",endpoint:"webservices/order_report.json"},PROPERTY_COMPS:{methodName:"propertyComps",endpoint:"webservices/property_comps.json"},PROPERTY_DETAILS:{methodName:"propertyDetails",endpoint:"webservices/property_details.json"},FARMS_PE_CHECK_STATUS:{methodName:"checkPEFarmStatus",endpoint:"webservices/pe_farm_status/{{farmId}}.json"},FARMS_GET_FARM:{methodName:"getFarmProperties",endpoint:"webservices/get_farm/{{farmId}}.json"},FARMS_GET_FARMS_LIST:{methodName:"getFarmsList",endpoint:"webservices/get_farm_metainfo.json"},GLOBAL_SEARCH:{methodName:"globalSearch",endpoint:"webservices/global_search.json"},GLOBAL_SEARCH_COUNT:{methodName:"globalSearchCount",endpoint:"webservices/global_search_count.json"},GET_TYPES_REPORT:{methodName:"getTypesReport",endpoint:"webservices/types_report.json"},GET_SEARCH_FIELDS:{methodName:"getSearchFields",endpoint:"webservices/get_search_fields.json"}},window.TTB=function(e){this.config=e,this.baseURLPattern=e.baseURLPattern||defaults.baseURLPattern,this.sponsor=e.sponsor||defaults.sponsor,this.baseURL=e.baseURL||this.setSponsor(this.sponsor),this.autoFillAttr=e.autoFillAttr||defaults.autoFillAttr,this.scopedBootstrap=e.scopedBootstrap||defaults.scopedBootstrap,this.debug=e.debug||defaults.debug,window.TTB.scopedBootstrap=window.TTB.scopedBootstrap?window.TTB.scopedBootstrap:this.scopedBootstrap,this._log(["TTB SDK instantiated. | version: ",window.TTB.version])},window.TTB.version="1.8.0",window.TTB.debug=!1,window.TTB._log=function(e){window.TTB.debug&&console.log.apply(console,[defaults.sdkPrefix+" :"].concat(e))},window.TTB._createDefaultInstance=function(e,t){return new TTB({partnerKey:e||defaults.partnerKey,sponsor:t})},window.TTB._getLocal=function(e){var t=window.localStorage.getItem(defaults.sdkPrefix+"--"+e);return JSON.parse(t)},window.TTB._setLocal=function(e,t){window.localStorage.setItem(defaults.sdkPrefix+"--"+e,JSON.stringify(t))},window.TTB._modal=function(e){var t,o;return e.id=e.id||defaults.sdkPrefix+"--"+Date.now(),e.sizeClass=e.sizeClass||defaults.modalOptions.sizeClass,e.autoDestroy=null!=e.autoDestroy?e.autoDestroy:defaults.modalOptions.autoDestroy,o=defaults.modalTemplate.replace(/\{\{modalId}}/g,e.id).replace("{{sizeClass}}",e.sizeClass).replace("{{title}}",e.title).replace("{{bodyContent}}",e.bodyContent),t=$(o).appendTo(document.body),e.onShown&&t.on("shown.bs.modal",e.onShown),t.on("show.bs.modal",function(){window.TTB.scopedBootstrap&&($("html").addClass(defaults.classScopedBootstrapHtml),$("body").addClass(defaults.classScopedBootstrapBody));e.onBeforeShow&&e.onBeforeShow()}),t.on("hide.bs.modal",function(){window.TTB.scopedBootstrap&&($("html").removeClass(defaults.classScopedBootstrapHtml),$("body").removeClass(defaults.classScopedBootstrapBody));e.onBeforeClose&&e.onBeforeClose()}),e.autoDestroy?t.on("hidden.bs.modal",function(){e.onClose&&e.onClose(),t.remove()}):e.onClose&&t.on("hide.bs.modal",e.onClose),t},window.TTB.utilIframeModal=function(e,t){var o,n;return t.height=t.height||defaults.iframeOptions.height,(n={}).src=t.origin+t.pathname+"?hostOrigin={{hostOrigin}}".replace("{{hostOrigin}}",window.location.origin),t.params&&$.each(t.params,function(e,t){n.src+=t?"&"+e+"="+encodeURIComponent(t):""}),n.iframeTemplate=['<iframe src="{{src}}" id="{{iframeId}}" name="{{iframeId}}" width="100%" height="{{height}}"></iframe>'].join("").replace("{{src}}",n.src).replace("{{height}}",t.height).replace(/\{\{iframeId}}/g,t.id),t.onMessage&&(window.addEventListener("message",s,!1),n.modalOptionsOnClose=e.onClose,e.onClose=function(){window.TTB._log(["utilIframeModal: onClose"]),n.modalOptionsOnClose&&n.modalOptionsOnClose(),window.removeEventListener("message",s)}),e.bodyContent=[e.bodyContent||"",n.iframeTemplate].join(""),(o=window.TTB._modal(e)).modal({}),o;function s(e){window.TTB._log(["utilIframeModal: receiveMessage: origin:",e.origin]),e.origin===t.origin&&(window.TTB._log(["utilIframeModal: receiveMessage: event: ",e]),t.onMessage(e.data,e))}},window.TTB.utilBuildSponsorInfo=function(e){return{name:e.vertical_name,title:e.company_info.company_name,site:e.site_url,logoURL:e.company_info.logo_url,TOSURL:e.TOS_content}},window.TTB.getUserProfile=function(e,t){var o=window.TTB._createDefaultInstance(t),n={method:"POST",data:JSON.stringify(e),xhrFields:{withCredentials:!1}};return o._ajax(n,methodsMapping.GET_USER_PROFILE)},window.TTB.getVendorProfile=function(e){var t=window.TTB._createDefaultInstance(e),o={url:(t.baseURL+methodsMapping.GET_VENDOR_PROFILE.endpoint).replace("{{partnerKey}}",e),method:"GET",xhrFields:{withCredentials:!1}};return t._ajax(o,methodsMapping.GET_VENDOR_PROFILE)},window.TTB.getSponsors=function(e,t){var o=window.TTB._createDefaultInstance(t),n={method:"POST",data:JSON.stringify(e)};return o._ajax(n,methodsMapping.GET_SPONSORS)},window.TTB.getSponsorSelection=function(e,t){var o=window.TTB._createDefaultInstance(e),n={method:"POST",data:JSON.stringify(t)};return o._ajax(n,methodsMapping.GET_SPONSOR_SELECTION)},window.TTB.showSelectSponsor=function(e,t){var o,n,s;return o="ttb-sdk--select-sponsor",s="<h3>{{message}}</h3>",n=this._modal({id:o,title:"Please select a Company to Partner with on your Data Integration",bodyContent:s.replace("{{message}}","Retrieving list of all available Companies ...")}),window.TTB.getSponsors(e.getSponsorsPayload,e.partnerKey).done(function(a){var i,r;if(i={sponsorsData:void 0,bodyTemplate:void 0,bodyMarkup:void 0,sponsorTemplate:void 0,sponsorMarkup:void 0,sponsorsEmailMarkup:void 0,sponsorsZipMarkup:void 0,sponsorTOSTemplate:void 0,sponsorTOSMarkup:void 0,$sponsorTOSModal:void 0,resultsMessage:void 0,tempTargetList:void 0},"OK"!==a.response.status)return window.TTB._log(["showSelectSponsor: getSponsors: error in response: ",a.response]),r=s.replace("{{message}}","Failed in retrieving companies list."),n.find(".modal-body").html(r),void(t.onError&&t.onError(a.response.data[0],n));i.sponsorsData=a.response.data,i.bodyMarkup=[],i.sponsorsEmailMarkup=[],i.sponsorsZipMarkup=[],i.sponsorsOtherMarkup=[],i.sponsorTemplate=["<tr>",' <th scope="row">{{count}}</th>',' <td><img src="{{logoUrl}}" class="img-responsive" alt="Sponsor Logo"></td>'," <td>{{name}}</td>",' <td><a href="{{website}}" target="_blank">{{website}}</a></td>',' <td class="text-center">','  <button class="btn btn-primary"','   data-sponsor-name="{{sponsorName}}"','   data-sponsor-title="{{sponsorTitle}}"','   data-sponsor-site="{{sponsorSite}}"','   data-sponsor-logo="{{sponsorLogoURL}}"','   data-sponsor-tos="{{sponsorTOSURL}}">',"  Select","  </button>"," </td>","</tr>"].join(""),i.bodyTemplate=["<h3>{{resultsMessage}}</h3>",'<div style="overflow-x: auto">','<table class="table">'," <thead>","  <tr>",'   <th scope="col" width="80" class="text-center">#</th>','   <th scope="col" width="80" class="text-center">Logo</th>','   <th scope="col" width="80" class="text-center">Name</th>','   <th scope="col" width="80" class="text-center">Website</th>','   <th scope="col" width="80" class="text-center"></th>',"  </tr>"," <thead>",' <tbody class="align-items-center">{{sponsorsMarkup}}</tbody>',"</table>","</div>"].join(""),$.each(i.sponsorsData,function(e,t){switch(i.sponsorMarkup=i.sponsorTemplate.replace("{{logoUrl}}",t.company_info.logo_url).replace("{{name}}",t.company_info.company_name).replace(/(\{\{website}})/g,t.company_info.company_website).replace("{{sponsorName}}",t.vertical_name).replace("{{sponsorTitle}}",t.company_info.company_name).replace("{{sponsorSite}}",t.site_url).replace("{{sponsorLogoURL}}",t.company_info.logo_url).replace("{{sponsorTOSURL}}",t.TOS_content),t.match.type){case"email":i.tempTargetList=i.sponsorsEmailMarkup;break;case"zip":i.tempTargetList=i.sponsorsZipMarkup;break;case null:i.tempTargetList=i.sponsorsOtherMarkup;break;default:return void window.TTB._log(["showSelectSponsor: unknown sponsor.match.type: ",t.match.type])}i.sponsorMarkup=i.sponsorMarkup.replace("{{count}}",i.tempTargetList.length+1),i.tempTargetList.push(i.sponsorMarkup)}),i.sponsorsEmailMarkup.length&&(i.resultsMessage="It appears you currently partner with the following Companies ...",i.bodyMarkup.push(i.bodyTemplate.replace("{{resultsMessage}}",i.resultsMessage).replace("{{sponsorsMarkup}}",i.sponsorsEmailMarkup.join("")))),i.sponsorsZipMarkup.length&&(i.resultsMessage="The following Companies are available Partners in the <strong>{{zipCode}}</strong> zip code.".replace("{{zipCode}}",e.getSponsorsPayload.zipCode),i.bodyMarkup.push(i.bodyTemplate.replace("{{resultsMessage}}",i.resultsMessage).replace("{{sponsorsMarkup}}",i.sponsorsZipMarkup.join("")))),!i.sponsorsOtherMarkup.length||i.sponsorsZipMarkup.length||i.sponsorsEmailMarkup.length||(1===i.sponsorsData.length&&"leads"===i.sponsorsData[0].vertical_name?i.resultsMessage=["There is currently not a Company as a participating Partner in Zip Code <strong>{{zipCode}}</strong>. ","The Data will be proudly supplied by Benutech Inc."].join("").replace("{{zipCode}}",e.getSponsorsPayload.zipCode):i.resultsMessage="The following Companies are available Partners.",i.bodyMarkup.push(i.bodyTemplate.replace("{{resultsMessage}}",i.resultsMessage).replace("{{sponsorsMarkup}}",i.sponsorsOtherMarkup.join("")))),n.find(".modal-body").html(i.bodyMarkup.join("")),$("#"+o+" tbody").on("click","button",function(o){var s={name:$(this).attr("data-sponsor-name"),title:$(this).attr("data-sponsor-title"),site:$(this).attr("data-sponsor-site"),logoURL:$(this).attr("data-sponsor-logo"),TOSURL:$(this).attr("data-sponsor-tos")};window.TTB.showSponsorTOSModal(s,t,{performLogin:void 0===e.performLogin||e.performLogin,userProfile:e.userProfile,partnerKey:e.partnerKey,loginRemotePayload:e.loginRemotePayload}),n.modal("hide")})}).fail(function(e){var o;o=s.replace("{{message}}","Failed in retrieving companies list."),n.find(".modal-body").html(o),t.onError&&t.onError(o,n)}),n.modal({})},window.TTB.showSponsorTOSModal=function(e,t,o){var n,s,a,i,r,l;return o=o||{},"ttb-sdk--sponsor-tos-modal",n=window.TTB._createDefaultInstance(o.partnerKey,e),a=["Thank you for choosing <br>{{sponsorTitle}} <br> as your partner. <br>",'<p id="ttb-sdk--sponsor-tos-message">Please read and agree to {{sponsorTitle}} <a href="{{sponsorTOSURL}}" target="_blank">Terms and conditions</a></p>'].join(""),r=['<div class="form-group form-check" id="ttb-sdk--sponsor-tos-check">',' <input id="ttb-sdk--sponsor-tos-agree" type="checkbox" class="form-check-input">',' <label class="form-check-label" for="ttb-sdk--sponsor-tos-agree">I hereby agree</label>',"</div>",'<button id="ttb-sdk--sponsor-selection-finish" type="button" class="btn btn-success btn-block" disabled>Finish</button>'].join(""),i=a.replace(/\{\{sponsorTitle}}/g,e.title).replace("{{sponsorTOSURL}}",e.TOSURL),l=r,s=window.TTB._modal({id:"ttb-sdk--sponsor-tos-modal",sizeClass:" ",title:i,bodyContent:l}),$("#ttb-sdk--sponsor-tos-agree").on("change",function(){var e=$(this).prop("checked");$("#ttb-sdk--sponsor-selection-finish").prop("disabled",!e)}),$("#ttb-sdk--sponsor-selection-finish").on("click",function(){var a;window.TTB._log(["saveSponsor: called"]),d("Saving Selection...",!0),a=o.userProfile?{data:{User:o.userProfile}}:o.loginRemotePayload,n.saveSponsorSelection(a,!1).then(function(a){"OK"===(a=a.response).status?(window.TTB._log(["saveSponsor: success",a]),d("Selection Saved!",!0),o.userProfile&&(o.loginRemotePayload.stk=a.data.stk,o.loginRemotePayload.getuser_url=a.data.getuser_url),t.onSelect&&t.onSelect(e,o.loginRemotePayload,s),o.performLogin&&(window.TTB._log(["performLogin: called"]),d("Authenticating...",!0),n.loginRemote(o.loginRemotePayload,!1).then(function(a){var i;"OK"===(a=a.response).status?(window.TTB._log(["performLogin: success",a]),window.TTB._log(["TOSAccept: called"]),d("Accepting Terms...",!0),i={method:"GET"},n._ajax(i,methodsMapping.ACCEPT_SPONSOR_TOS).then(function(n){n=n.response,window.TTB._log(["TOSAccept: complete",n]),"OK"===n.status?(window.TTB._log(["TOSAccept: success",n]),t.onConnect&&t.onConnect(e,o.loginRemotePayload,s),d("Connected !",!1)):(window.TTB._log(["TOSAccept: failed",n]),c(n.data.msg))},function(e){window.TTB._log(["TOSAccept: error",e]),c("Failed in contacting server for accepting Terms.")})):(window.TTB._log(["performLogin: failed",a]),c(a.data[0]))},function(e){window.TTB._log(["performLogin: error",e]),c("Failed in contacting server for login.")}))):(window.TTB._log(["saveSponsor: failed",a]),c(a.data[0]))},function(e){window.TTB._log(["saveSponsor: error",e]),c("Failed in contacting server for saving partner.")})}),o.performLogin||($("#ttb-sdk--sponsor-tos-message").hide(),$("#ttb-sdk--sponsor-tos-check").hide(),$("#ttb-sdk--sponsor-selection-finish").prop("disabled",!1)),s.modal({});function d(e,t){$("#ttb-sdk--sponsor-selection-finish").text(e||"").prop("disabled",t)}function c(e){t.onError&&t.onError(e,s)}},window.TTB.renderLogoWidget=function(e,t){var o,n,s;return o=window.location.port===defaults.devPort?"http://localhost:9001":"https://ttb-landing-page.herokuapp.com",o+="/?stk={{stk}}&getuser_url={{getuser_url}}&partnerKey={{partnerKey}}&enabled_features={{enabled_features}}&debug={{debug}}".replace("{{stk}}",t.stk).replace("{{getuser_url}}",encodeURIComponent(t.getuser_url)).replace("{{partnerKey}}",t.partnerKey).replace("{{enabled_features}}",defaults.enabledFeatures).replace("{{debug}}",window.TTB.debug),n=['<a class="ttb-sdk--render-logo--link" target="_blank" href="{{generatedURL}}" title="Title ToolBox - Full Profile and Net Sheet Report Lookup">',' <img class="ttb-sdk--render-logo--image" src="https://demo.titletoolbox.com/assets/images/logo_in.png" style="background-color: #389ae5;">',"</a>"].join("").replace("{{generatedURL}}",o),(s=document.querySelector(e)).innerHTML+=n,s},window.TTB.prototype={_log:function(e){this.config.debug&&console.log.apply(console,[defaults.sdkPrefix+" :"].concat(e))},_fillFields:function(selector,data,clearExisting,delay){var _self,$fields,model,modelValue,fillValue,timeout;_self=this,$fields=$(selector).find("input["+_self.autoFillAttr+"]"),delay?(timeout=0,fillValue=function(e,t){timeout+=delay,setTimeout(function(){e.val(t)},timeout)}):fillValue=function(e){$(this).val(e)},$fields.each(function(){model=$(this).attr(_self.autoFillAttr),clearExisting&&$(this).val(void 0);try{modelValue=eval("data."+model),modelValue&&fillValue($(this),modelValue)}catch(e){_self._log([defaults.sdkPrefix," : autoFill : ",model,": skipping - invalid model"])}})},_fillField:function(e,t,o){var n;(n=$(e).find("input["+this.autoFillAttr+'="'+t+'"]')).length?n.val(o):this._log([defaults.sdkPrefix," : autoFill : skipping : field not found - ",t])},_ajax:function(e,t,o){var n,s;return n=this,e.url=e.url||this.baseURL+t.endpoint,e.url=o?e.url+"?"+$.param(o):e.url,s=$.extend(e,{headers:{"Partner-Key":this.config.partnerKey,"Third-Party":!0},xhrFields:e.xhrFields||{withCredentials:!0}}),$.ajax(s).done(function(e){return"string"==typeof e||e instanceof Array||"OK"===(e.response||e).status?n._log([defaults.sdkPrefix+" :",t.methodName+"() [",t.endpoint,"]",": success :",e]):n._log([defaults.sdkPrefix+" :",t.methodName+"() [",t.endpoint,"]",": error :",e]),e}).fail(function(e){return n._log([defaults.sdkPrefix+" :",t.methodName+"() [",t.endpoint,"]",": fail :",e]),401===e.status&&n.config.onSessionExpire&&n.config.onSessionExpire({requestConfig:s,requestError:e,methodName:t.methodName,endpoint:t.endpoint,retry:function(){return $.ajax(s)}}),e})},setSponsor:function(e){return this.sponsor=e,this.baseURL=this.baseURLPattern.replace("{{sponsorName}}",e.name)},showTOS:function(){var e;return"ttb-sdk--sponsor-tos",e=['<iframe src="{{src}}" width="100%" height="600px"></iframe>',"</div>"].join("").replace("{{src}}",this.sponsor.TOSURL),window.TTB._modal({id:"ttb-sdk--sponsor-tos",title:"Terms of Service",bodyContent:e}).modal({})},handleSponsorTOS:function(e){var t;return"ttb-sdk--handle-sponsor-tos",this.setSponsor(e),t=['<iframe src="{{src}}" width="100%" height="600px"></iframe>',"</div>"].join("").replace("{{src}}",this.sponsor.TOSURL),window.TTB._modal({id:"ttb-sdk--handle-sponsor-tos",title:"Terms of Service",bodyContent:t}).modal({})},loginRemote:function(e){e.sso=!1;var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.LOGIN_REMOTE)},login:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.LOGIN)},logout:function(){return this._ajax({method:"GET"},methodsMapping.LOGOUT)},searchByParcelNumber:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.SEARCH_PARCEL)},searchBySiteAddress:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.SEARCH_PROPERTY)},searchByOwnerName:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.SEARCH_OWNER)},orderReport:function(e){e.output=e.output||"link",e.report_type=e.report_type||"property_profile";var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.ORDER_REPORT)},propertyComps:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.PROPERTY_COMPS)},propertyDetails:function(e,t){var o;o=this,t=t||{autoFillContext:null};var n={method:"POST",data:JSON.stringify(e)};return this._ajax(n,methodsMapping.PROPERTY_DETAILS).then(function(e){return t.autoFillContext&&o._fillFields(t.autoFillContext,e.response.data,t.autoFillClearExisting,t.autoFillDelay),e})},checkPEFarmStatus:function(e){var t={method:"GET",url:(this.baseURL+methodsMapping.FARMS_PE_CHECK_STATUS.endpoint).replace("{{farmId}}",e)};return this._ajax(t,methodsMapping.FARMS_PE_CHECK_STATUS)},getFarmProperties:function(e){var t={method:"GET",url:(this.baseURL+methodsMapping.FARMS_GET_FARM.endpoint).replace("{{farmId}}",e)};return this._ajax(t,methodsMapping.FARMS_GET_FARM)},getFarmsList:function(){return this._ajax({method:"GET"},methodsMapping.FARMS_GET_FARMS_LIST)},globalSearch:function(e,t){var o={method:"POST",data:JSON.stringify(e)};return this._ajax(o,methodsMapping.GLOBAL_SEARCH,t)},globalSearchCount:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.GLOBAL_SEARCH_COUNT)},nearbySearch:function(e,t){var o={limit:e.limit||1e3,page:1},n={mm_fips_state_code:e.mm_fips_state_code,use_code_std:["RSFR","RCON"],customFilters:{},searchOptions:{max_limit:e.limit||void 0},geometry:{match:"circle",value:{center_lat:e.center_lat,center_lng:e.center_lng,radius:e.radius}}};n=$.extend(n,t);var s={method:"POST",data:JSON.stringify(n)};return this._ajax(s,methodsMapping.GLOBAL_SEARCH,o)},getTypesReport:function(){return this._ajax({method:"GET"},methodsMapping.GET_TYPES_REPORT)},getSearchFields:function(){return this._ajax({method:"GET"},methodsMapping.GET_SEARCH_FIELDS)},saveSponsorSelection:function(e,t){var o={method:"POST",data:JSON.stringify(e)},n={save_and_login:!!t};return this._ajax(o,methodsMapping.SAVE_SPONSOR_SELECTION,n)},clearSponsorSelection:function(e){var t={method:"POST",data:JSON.stringify(e)};return this._ajax(t,methodsMapping.CLEAR_SPONSOR_SELECTION)},googleBuildAddress:function(e,t){var o,n,s,a,i,r;n={},r={street_number:{field_name:"site_street_number",name_type:"short_name"},route:{field_name:"site_route",name_type:"short_name"},locality:{field_name:"site_city",name_type:"long_name"},neighborhood:{field_name:"site_neighborhood",name_type:"long_name"},administrative_area_level_1:{field_name:"site_state",name_type:"short_name"},administrative_area_level_2:{field_name:"site_county",name_type:"short_name"},postal_code:{field_name:"site_zip",name_type:"short_name"}};for(var l=0,d=(o=e.getPlace()).address_components.length;l<d;l++)r[a=(s=o.address_components[l]).types[0]]&&(i=s[r[a].name_type],n[r[a].field_name]=i,t&&t.autoFillContext&&this._fillField(t.autoFillContext,r[a].field_name,i));return(n.site_street_number||n.site_route)&&(n.site_address=(n.site_street_number||"")+(n.site_street_number&&n.site_route?" ":"")+(n.site_route||"")),n.site_county=n.site_county?n.site_county.replace(" County",""):void 0,n},instantLookupWidget:function(e,t){var o,n,s;if(s=this,t=t||{},(o={}).selectedAction=window.TTB._getLocal("selectedAction",o.selectedAction)||{name:"fullProfileReport",label:"Full Profile Report"},o.widgetClass="ttb-sdk--instant-lookup--container",o.widgetTemplate=["\x3c!-- the wait spinner box --\x3e",'<div class="col-xs-12">',' <i class="ttb-sdk--spinner"></i>',"</div>","\x3c!-- the google autocomplete address lookup --\x3e",'<div id="ttb-sdk--instant-lookup--address" class="col-xs-12 col-md-7">',' <div class="">1 - Type in and select the property address below</div>',' <div class="ttb-sdk--instant-lookup--auto-complete-wrapper">','  <input type="text" class="form-control" id="ttb-sdk--instant-lookup--auto-complete" name="ttb-sdk--instant-lookup--auto-complete" placeholder="Search for an address...">'," </div>",'<i class="ttb-sdk--icon--right-arrow"></i>',"</div>","\x3c!-- actions menu --\x3e",'<div id="ttb-sdk--instant-lookup--actions" class="col-xs-12 col-md-5">',' <div class="">2 - Select the type of report you want below</div>'," \x3c!-- split button --\x3e",' <div class="btn-group col-xs-12" dropdown="">',"  \x3c!-- dynamic placeholder to contain last selected action --\x3e",'  <button type="button" id="ttb-sdk--instant-lookup--selected-action" class="btn btn-default col-xs-10">{{selectedActionLabel}}</button>','  <button type="button" class="btn btn-default dropdown-toggle col-xs-2" data-dropdown-toggle="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">','  <span class="caret"></span>','  <span class="sr-only">Toggle Dropdown</span>',"  </button>",'  <ul class="dropdown-menu">','  <li><a data-action-name="netSheet" href="javascript:">NetSheet</a></li>','  <li><a data-action-name="fullProfileReport" href="javascript:">Full Profile Report</a></li>',"  </ul>"," </div>","</div>",'<div id="ttb-sdk--instant-lookup--alert" class="col-xs-12 text-center">',' <div class="alert alert-warning" style="border: 1px solid;">',' Looks like you have not allowed popups for our site, yet. You can click <a href="javascript:" target="_blank">here</a> to get your report.'," </div>","</div>",'<div class="col-xs-12 ttb-sdk--instant-lookup--footer text-center">','<i class="ttb-sdk--icon--info"></i>'," Your report will automatically be created and displayed for you.","</div>"].join("").replace("{{selectedActionLabel}}",o.selectedAction.label),o.$container=$(e),!o.$container.length)return this._log([defaults.sdkPrefix," : instantLookupWidget : abort : element not found - ",e]),null;o.$container.addClass(o.widgetClass).append(o.widgetTemplate),window.TTB.scopedBootstrap&&o.$container.addClass(defaults.classScopedBootstrap).addClass(defaults.classScopedBootstrapBody);try{google.maps.places.Autocomplete}catch(e){this._log([defaults.sdkPrefix,' : instantLookupWidget : abort : "google.maps.places.Autocomplete" not found -'," please make sure the google script was loaded and that instantLookupWidget() is being called inside/after google load cb is "," called i.e. googleInit() or the mentioned callback=* in the google script src value."])}function a(){$("#ttb-sdk--instant-lookup--alert").hide().find("a").attr("href","javascript:")}function i(){var t,i;a(),o.selectedAddressInfo?(o.$container.find(".ttb-sdk--spinner").addClass("active"),n.$element.prop("disabled",!0),o.$selectedAction.prop("disabled",!0).next("button").prop("disabled",!0),t=function(){o.$container.find(".ttb-sdk--spinner").removeClass("active"),n.$element.prop("disabled",!1),o.$selectedAction.prop("disabled",!1).next("button").prop("disabled",!1)},i=function(e){s._log(["instantLookupWidget : searchBySiteAddress - handleError - ",e]),t(),alert("TTB - Lookup Failed. \nReason: "+e),r(!1,{message:e})},s.searchBySiteAddress(o.selectedAddressInfo).then(function(n){var a,l,d,c,p,u,m,g;if(s._log([defaults.sdkPrefix," : instantLookupWidget : searchBySiteAddress - complete - ",n]),"OK"===(n=n.response).status&&n.data&&n.data.length)if(n.data.length>1)i("Multiple records found, please refine your search to make it more specific.");else switch(a=n.data[0],o.selectedAction.name){case"netSheet":s._log([defaults.sdkPrefix," : instantLookupWidget : netSheet - "]),c=a,p=t,u={id:"ttb-sdk--net-sheet--modal",title:"Net Sheet"},g=window.location.port===defaults.devPort?"http://localhost:9002":"https://ttb-export.herokuapp.com",m={id:"ttb-sdk--net-sheet--iframe",height:"635px",origin:g,pathname:"/netsheet",params:{partnerKey:s.config.partnerKey,verticalName:s.sponsor.name,verticalTitle:s.sponsor.title,propertyId:c.sa_property_id,propertyAddress:c.v_mail_address,debug:s.debug}},window.TTB.utilIframeModal(u,m),p(),r(!0,{message:"Net Sheet Opened."});break;case"fullProfileReport":s._log([defaults.sdkPrefix," : instantLookupWidget : fullProfileReport"]),l=a,d=t,s.orderReport({sa_property_id:l.sa_property_id,state_county_fips:l.mm_fips_state_code+l.mm_fips_muni_code,report_type:"property_profile",output:"link"}).then(function(e){var t;t=e.response.data.report.link,window.open(t)||$("#ttb-sdk--instant-lookup--alert").show().find("a").attr("href",t),d(),r(!0,{reportLink:t})},function(){var e="Failed in getting full profile report.";alert(e),d(),r(!1,{message:e})});break;default:s._log([defaults.sdkPrefix," : instantLookupWidget : action not found - ",e]),t()}else i(n.data?n.data[0]:"Failed in property lookup.")},function(){i("Failed in connecting to the server.")})):n.$element.focus()}function r(e,n){t[o.selectedAction.name]&&t[o.selectedAction.name]({success:e,data:n})}(n={}).$element=o.$container.find("#ttb-sdk--instant-lookup--auto-complete"),n.instance=new google.maps.places.Autocomplete(n.$element[0],{types:["geocode"]}),n.instance.addListener("place_changed",function(){a(),o.selectedAddressInfo=s.googleBuildAddress(n.instance)}),o.$selectedAction=o.$container.find("#ttb-sdk--instant-lookup--selected-action"),o.$selectedAction.on("click",i),o.$container.find("#ttb-sdk--instant-lookup--actions ul").on("click",function(e){t=e,o.selectedAction.name=$(t.target).data("action-name"),o.selectedAction.label=$(t.target).text(),o.$selectedAction.text(o.selectedAction.label||""),window.TTB._setLocal("selectedAction",o.selectedAction),i();var t})},connectWidget:function(e,t){var o,n,s,a;if(n=this,s="connect--selected-sponsor",t=t||{},(o={}).userProfile=void 0,o.selectedSponsor=window.TTB._getLocal(s),o.widgetClass="ttb-sdk--connect--container",o.widgetTemplate=['<div id="ttb-sdk--connect--connect-section" class="row">',' <div id="ttb-sdk--connect--alert" class="col-xs-9">',' No Partner - Please click "Connect" to select one.'," </div>",' <div id="ttb-sdk--connect--connect" class="col-xs-3">','  <button type="button" class="btn btn-primary pull-right">Connect</button>'," </div>","</div>","\x3c!-- hidden by default --\x3e",'<div id="ttb-sdk--connect--disconnect-section" class="row" style="display: none;">',' <div class="col-xs-4">',"  <strong>Title company</strong>"," </div>"," \x3c!-- to be dynamically updated --\x3e",' <div id="ttb-sdk--connect--company-name" class="col-xs-4">',"  - "," </div>",' <div id="ttb-sdk--connect--disconnect" class="col-xs-4">','  <button type="button" class="btn btn-primary pull-right">Change</button>'," </div>","</div>"].join(""),o.$container=$(e.elementSelector),!o.$container.length)return this._log(["connectWidget : abort : element not found - ",e.elementSelector]),null;function i(e,n){o.$container.find("#ttb-sdk--connect--connect-section").hide().next("#ttb-sdk--connect--disconnect-section").show().find("#ttb-sdk--connect--company-name").text(e.title||""),t.onConnectSuccess&&t.onConnectSuccess({selectedSponsor:e,loginPerformed:n})}function r(e,t){o.$container.find("#ttb-sdk--connect--alert").text(e||"").next("#ttb-sdk--connect--connect").find("button").prop("disabled",t)}o.$container.addClass(o.widgetClass).append(o.widgetTemplate),window.TTB.scopedBootstrap&&o.$container.addClass(defaults.classScopedBootstrap).addClass(defaults.classScopedBootstrapBody),a=function(e,o){r(e,o),t.onConnectFailure&&t.onConnectFailure(e)},r("Pulling user profile...",!0),window.TTB.getUserProfile(e.loginRemotePayload,n.config.partnerKey).then(function(e){var t;e.data&&e.data.User?(o.userProfile=e.data.User,r("Checking current partner selection...",!0),t={email:o.userProfile.email},window.TTB.getSponsorSelection(n.config.partnerKey,t).then(function(e){var t;"OK"===(e=e.response).status?(t=window.TTB.utilBuildSponsorInfo(e.data),r("Partner selection found.",!1),i(t,!1)):a(e.data[0],!1)},function(e){a("Error in contacting server for pulling partner selection.",!1)})):a("Failed in pulling user profile.",!0)},function(e){a("Error in contacting server for pulling user profile.",!0)}),o.$container.find("#ttb-sdk--connect--connect-section button").on("click",function(){var o,a,l,d;n._log(["connectWidget: onConnect: init."]),a={id:"ttb-sdk--connect--modal",title:"Connect with TitleToolbox"},d=window.location.port===defaults.devPort?"http://localhost:9001":"https://ttb-landing-page.herokuapp.com",l={id:"ttb-sdk--connect--iframe",height:"635px",origin:d,pathname:"/index.html",params:{stk:e.loginRemotePayload.stk,getuser_url:e.loginRemotePayload.getuser_url,partnerKey:n.config.partnerKey,debug:n.debug},onMessage:function(e,a){if(n._log(["connectWidget: onMessage",e]),-1===e.action.indexOf("TTB:SDK::CONNECT_WIDGET"))return;switch(o.modal("hide"),e.action){case"TTB:SDK::CONNECT_WIDGET:ERROR":t.onConnectFailure&&t.onConnectFailure(e.info.reason),r(e.info.reason,!1);break;case"TTB:SDK::CONNECT_WIDGET:SUCCESS":l=e,window.TTB._setLocal(s,l.info.selectedSponsor),i(l.info.selectedSponsor,!0);break;default:return void n._log(["connectWidget: onMessage: unknown action",e.action])}var l}},o=window.TTB.utilIframeModal(a,l)}),o.$container.find("#ttb-sdk--connect--disconnect-section button").on("click",function(){n._log(["connectWidget: onDisconnect: called."]),window.TTB._setLocal(s,null),a="Disconnected.",i=!1,o.$container.find("#ttb-sdk--connect--company-name").text(a||"").next("#ttb-sdk--connect--disconnect").find("button").prop("disabled",i),e=n.sponsor,o.$container.find("#ttb-sdk--connect--connect-section").show().find("#ttb-sdk--connect--alert").text('No Partner - Please click "Connect" to select one.').end().next("#ttb-sdk--connect--disconnect-section").hide().find("#ttb-sdk--connect--company-name").text(""),t.onDisconnectSuccess&&t.onDisconnectSuccess({selectedSponsor:e}),$("#ttb-sdk--connect--connect button").trigger("click");var e;var a,i})}}}();